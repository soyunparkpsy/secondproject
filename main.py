import streamlit as st
import folium
from streamlit_folium import st_folium
import pandas as pd # ë°ì´í„° ê´€ë¦¬ë¥¼ ìœ„í•´ pandas ì¶”ê°€

st.set_page_config(page_title="ìº˜ë¦¬í¬ë‹ˆì•„ ê´€ê´‘ ê°€ì´ë“œ", layout="wide")

st.title("ğŸŒ´ ìº˜ë¦¬í¬ë‹ˆì•„ ê´€ê´‘ & ë§›ì§‘ ê°€ì´ë“œ")
st.markdown("""
ë¯¸êµ­ ì„œë¶€ì˜ ë³´ì„, **ìº˜ë¦¬í¬ë‹ˆì•„** ğŸ„â€â™€ï¸  
ê´€ê´‘ëª…ì†Œë¶€í„° í˜„ì§€ì¸ ë§›ì§‘ê¹Œì§€, ì´ ê°€ì´ë“œ í•˜ë‚˜ë©´ ì—¬í–‰ ì¤€ë¹„ ë!
""")

# ê´€ê´‘ì§€ì™€ ë§›ì§‘ ë°ì´í„° (DataFrameìœ¼ë¡œ ê´€ë¦¬í•˜ì—¬ ìœ ì—°ì„± í™•ë³´)
locations_data = {
    "name": [
        "ìƒŒí”„ë€ì‹œìŠ¤ì½” ê¸ˆë¬¸êµ", "ì¸ì•¤ì•„ì›ƒ ë²„ê±° (In-N-Out)", "ìš”ì„¸ë¯¸í‹° êµ­ë¦½ê³µì›",
        "í•„ì¦ˆ ì»¤í”¼ (Philz Coffee)", "ë””ì¦ˆë‹ˆëœë“œ ë¦¬ì¡°íŠ¸", "Roscoe's Chicken and Waffles",
        "ìƒŒë””ì—ì´ê³  ë¼í˜¸ì•¼ ë¹„ì¹˜", "ê·¸ë¦¬í”¼ìŠ¤ ì²œë¬¸ëŒ€", "ì‚°íƒ€ëª¨ë‹ˆì¹´ í”¼ì–´", "ê²Œí‹° ì„¼í„°"
    ],
    "type": [
        "ê´€ê´‘ì§€", "ë§›ì§‘", "ê´€ê´‘ì§€", "ë§›ì§‘", "ê´€ê´‘ì§€", "ë§›ì§‘", "ê´€ê´‘ì§€", "ê´€ê´‘ì§€", "ê´€ê´‘ì§€", "ê´€ê´‘ì§€"
    ],
    "desc": [
        "ì„¸ê³„ì—ì„œ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ í˜„ìˆ˜êµ ì¤‘ í•˜ë‚˜. ì¸ìƒìƒ· ëª…ì†ŒğŸ“¸",
        "ìº˜ë¦¬í¬ë‹ˆì•„ì˜ êµ­ë¯¼ë²„ê±°! ë¹„ë°€ ë©”ë‰´ â€˜ì• ë‹ˆë©€ ìŠ¤íƒ€ì¼â€™ ê¼­ ë„ì „ğŸ”",
        "ëŒ€ìì—°ì˜ ê²½ì´ë¡œì›€ì´ í¼ì³ì§€ëŠ” ì ˆê²½ì˜ êµ­ë¦½ê³µì›â›°ï¸",
        "ì§ì ‘ ë¸”ë Œë”©í•œ ê°œì„±ìˆëŠ” ì»¤í”¼â˜• ë¡œì»¬ ê°ì„± ì¶©ë§Œ!",
        "ê¿ˆê³¼ í™˜ìƒì˜ ë‚˜ë¼! ê°€ì¡± ë‹¨ìœ„ ì—¬í–‰ê°ì—ê²Œ ì¶”ì²œğŸ¢",
        "í”„ë¼ì´ë“œ ì¹˜í‚¨ + ì™€í”Œì˜ í™©í™€í•œ ì¡°í•©ğŸ—ğŸ§‡",
        "ë°”ë‹¤ì‚¬ìë„ êµ¬ê²½í•˜ê³ , ì—ë©”ë„ë“œë¹› ë°”ë‹¤ì—ì„œ íë§ğŸ¬",
        "í• ë¦¬ìš°ë“œ ì‚¬ì¸ì„ ë³¼ ìˆ˜ ìˆëŠ” ìµœê³ ì˜ ë·°í¬ì¸íŠ¸. LA ì•¼ê²½ ê°ìƒì— ìµœê³ !ğŸŒƒ",
        "íƒœí‰ì–‘ì˜ ì•„ë¦„ë‹¤ìš´ ë…¸ì„ì„ ê°ìƒí•˜ë©° ì¦ê¸¸ ìˆ˜ ìˆëŠ” LA ëŒ€í‘œ í•´ë³€ ìœ ì›ì§€ğŸ¡",
        "ì›…ì¥í•œ ê±´ì¶•ë¬¼ê³¼ ì„¸ê³„ì ì¸ ì˜ˆìˆ  ì‘í’ˆë“¤ì„ ë¬´ë£Œë¡œ ê°ìƒí•  ìˆ˜ ìˆëŠ” ê³³ğŸ›ï¸"
    ],
    "lat": [
        37.8199, 37.8080, 37.8651, 37.7749, 33.8121, 34.0900, 32.8500, 34.1185, 34.0089, 34.0781
    ],
    "lon": [
        -122.4783, -122.4098, -119.5383, -122.4194, -117.9190, -118.3446, -117.2720, -118.3004, -118.4984, -118.4757
    ]
}
df = pd.DataFrame(locations_data)

st.markdown("---")

## ğŸ“ ì–´ë””ë¡œ ë– ë‚˜ë³¼ê¹Œìš”?

### ğŸ—ºï¸ ê´€ê´‘ì§€ì™€ ë§›ì§‘ ìœ„ì¹˜

# ì‚¬ì´ë“œë°” ì¶”ê°€
st.sidebar.header("í•„í„°ë§ ì˜µì…˜")
# ì‚¬ìš©ì ì…ë ¥: ì§€ì—­ ì„ íƒ (ì˜ˆì‹œë¡œ ë„ì‹œëª… ì¶”ê°€)
city_options = ["ì „ì²´"] + sorted(list(set(["ìƒŒí”„ë€ì‹œìŠ¤ì½”", "ë¡œìŠ¤ì•¤ì ¤ë ˆìŠ¤", "ìš”ì„¸ë¯¸í‹°", "ìƒŒë””ì—ì´ê³ "]))) # ë„ì‹œ ì¶”ê°€
selected_city = st.sidebar.selectbox("ë„ì‹œ ì„ íƒ:", city_options)

# ì‚¬ìš©ì ì…ë ¥: ì¹´í…Œê³ ë¦¬ ì„ íƒ
type_options = ["ì „ì²´"] + list(df["type"].unique())
selected_type = st.sidebar.selectbox("ì¹´í…Œê³ ë¦¬ ì„ íƒ:", type_options)

# ë°ì´í„° í•„í„°ë§
filtered_df = df.copy()
if selected_city != "ì „ì²´":
    if selected_city == "ìƒŒí”„ë€ì‹œìŠ¤ì½”":
        filtered_df = filtered_df[filtered_df["name"].isin(["ìƒŒí”„ë€ì‹œìŠ¤ì½” ê¸ˆë¬¸êµ", "ì¸ì•¤ì•„ì›ƒ ë²„ê±° (In-N-Out)", "í•„ì¦ˆ ì»¤í”¼ (Philz Coffee)"])]
    elif selected_city == "ë¡œìŠ¤ì•¤ì ¤ë ˆìŠ¤":
        filtered_df = filtered_df[filtered_df["name"].isin(["ë””ì¦ˆë‹ˆëœë“œ ë¦¬ì¡°íŠ¸", "Roscoe's Chicken and Waffles", "ê·¸ë¦¬í”¼ìŠ¤ ì²œë¬¸ëŒ€", "ì‚°íƒ€ëª¨ë‹ˆì¹´ í”¼ì–´", "ê²Œí‹° ì„¼í„°"])]
    elif selected_city == "ìš”ì„¸ë¯¸í‹°":
        filtered_df = filtered_df[filtered_df["name"].isin(["ìš”ì„¸ë¯¸í‹° êµ­ë¦½ê³µì›"])]
    elif selected_city == "ìƒŒë””ì—ì´ê³ ":
        filtered_df = filtered_df[filtered_df["name"].isin(["ìƒŒë””ì—ì´ê³  ë¼í˜¸ì•¼ ë¹„ì¹˜"])]

if selected_type != "ì „ì²´":
    filtered_df = filtered_df[filtered_df["type"] == selected_type]

# ì§€ë„ ì´ˆê¸°í™” (í•„í„°ë§ëœ ë°ì´í„°ì˜ ì¤‘ì•™ì„ ê¸°ì¤€ìœ¼ë¡œ)
if not filtered_df.empty:
    center_lat = filtered_df["lat"].mean()
    center_lon = filtered_df["lon"].mean()
    m = folium.Map(location=[center_lat, center_lon], zoom_start=6)
else: # í•„í„°ë§ëœ ë°ì´í„°ê°€ ì—†ì„ ê²½ìš° ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
    m = folium.Map(location=[36.7783, -119.4179], zoom_start=6)


# ë§ˆì»¤ ì¶”ê°€
for idx, loc in filtered_df.iterrows(): # DataFrame ë°˜ë³µ ì‹œ iterrows ì‚¬ìš©
    icon_color = "blue" if loc["type"] == "ê´€ê´‘ì§€" else "red"
    folium.Marker(
        location=[loc["lat"], loc["lon"]],
        popup=f"<b>{loc['name']}</b><br>{loc['desc']}",
        tooltip=loc["name"],
        icon=folium.Icon(color=icon_color)
    ).add_to(m)

st_data = st_folium(m, width=1000, height=600)

st.markdown("---")

## âœ¨ ì„¸ë¶€ ì •ë³´ ë° ì¶”ì²œ

# í•„í„°ë§ëœ ê²°ê³¼ ëª©ë¡ ì¶œë ¥
if not filtered_df.empty:
    st.markdown("### ğŸ“ ì„ íƒëœ ì¥ì†Œ ëª©ë¡:")
    for idx, row in filtered_df.iterrows():
        st.markdown(f"- **{row['name']}** ({row['type']}): {row['desc']}")
else:
    st.info("ì„ íƒí•˜ì‹  ì¡°ê±´ì— í•´ë‹¹í•˜ëŠ” ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í•„í„°ë¥¼ ì‹œë„í•´ ë³´ì„¸ìš”.")

st.markdown("---")

st.markdown("### â„¹ï¸ Tip")
st.info("ì§€ë„ì—ì„œ ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ ì„¤ëª…ì´ ë‚˜ì™€ìš”. ë§›ì§‘ì€ **ë¹¨ê°„ìƒ‰**, ê´€ê´‘ì§€ëŠ” **íŒŒë€ìƒ‰**ì´ì—ìš”. ì™¼ìª½ ì‚¬ì´ë“œë°”ì—ì„œ ì›í•˜ëŠ” **ë„ì‹œ**ì™€ **ì¹´í…Œê³ ë¦¬**ë¥¼ ì„ íƒí•˜ì—¬ ë§ì¶¤ ì •ë³´ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”!")
